<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FIRELEAF BOOKBUILDER</title>
    <meta
      name="description"
      content="Generate complete books using AI with customizable parameters"
    />
    <meta name="author" content="AI Book Generator" />

    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Minimal custom styles -->
    <link rel="stylesheet" href="styles/minimal.css" />

    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://api.openai.com" />
  </head>
  <body>
    <!-- Theme Toggle -->
    <button class="theme-toggle" id="theme-toggle" title="Toggle dark mode">
      <i class="fas fa-moon" id="theme-icon"></i>
    </button>

    <!-- Brain button -->
    <button
      id="brainBtn"
      class="icon-btn"
      title="Brain Assistant"
      style="display: inline-flex; align-items: center; gap: 0.5rem"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="22"
        height="22"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path
          d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"
        ></path>
        <path
          d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"
        ></path>
        <path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"></path>
        <path d="M17.599 6.5a3 3 0 0 0 .399-1.375"></path>
        <path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"></path>
        <path d="M3.477 10.896a4 4 0 0 1 .585-.396"></path>
        <path d="M19.938 10.5a4 4 0 0 1 .585.396"></path>
        <path d="M6 18a4 4 0 0 1-1.967-.516"></path>
        <path d="M19.967 17.484A4 4 0 0 1 18 18"></path>
      </svg>
      <span>Brain</span>
    </button>

    <!-- Auto-save Indicator -->
    <div class="auto-save-indicator" id="auto-save-indicator">
      <i class="fas fa-check-circle me-2"></i>Auto-saved
    </div>

    <!-- Loading overlay -->
    <div id="loading-overlay" class="loading-overlay d-none">
      <div class="loading-content">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p id="loading-text" class="mt-3">Generating content...</p>
        <div class="progress mt-3" style="width: 300px">
          <div
            id="progress-bar"
            class="progress-bar"
            role="progressbar"
            style="width: 0%"
          ></div>
        </div>
      </div>
    </div>

    <!-- Main container -->
    <div class="container-fluid">
      <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-8">
          <!-- Header -->
          <header class="text-center py-4">
            <h1 class="display-4 fw-bold text-primary">
              <i class="fas fa-book-open me-3"></i>
              FIRELEAF BOOKBUILDER
            </h1>
            <p class="lead text-muted">
              Create complete books using artificial intelligence
            </p>

            <!-- Statistics Dashboard -->
            <div class="stats-dashboard mt-4" id="stats-dashboard">
              <div class="stat-card">
                <div class="stat-value" id="stat-words">0</div>
                <div class="stat-label">Total Words</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="stat-chapters">0</div>
                <div class="stat-label">Chapters</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="stat-reading">0 min</div>
                <div class="stat-label">Reading Time</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="stat-progress">0%</div>
                <div class="stat-label">Completion</div>
              </div>
            </div>
          </header>

          <!-- Tabs -->
          <app-tabs>
            <nav>
              <button data-tab="ingest" data-label="Content Ingest"></button>
              <button
                data-tab="formatting"
                data-label="Book Configuration"
              ></button>
              <button data-tab="export" data-label="Export"></button>
              <button data-tab="brain" data-label="Brain"></button>
            </nav>

            <!-- üìù Ingest Pane -->
            <section id="ingest" class="tab-pane">
              <h4>Content Ingest</h4>
              <p>Upload or paste your book content to get started.</p>
            </section>

            <!-- ‚öôÔ∏è Formatting Pane -->
            <section id="formatting" class="tab-pane">
              <h4>Book Configuration</h4>
              <p>Configure structure, chapters, and formatting options.</p>
            </section>

            <!-- üì§ Export Pane -->
            <section id="export" class="tab-pane">
              <button id="btnExportDocx">üìÑ Download DOCX</button>
              <button id="btnExportEpub">üìö Download EPUB</button>

              <div id="downloadStatus" class="download-status" aria-live="polite">
                <div class="spinner"></div>
                <div
                  class="progress-wrap"
                  role="progressbar"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  aria-valuenow="0"
                >
                  <div class="progress-bar" id="downloadBar"></div>
                </div>
                <div class="progress-label" id="downloadPct">Preparing‚Ä¶</div>
              </div>
            </section>

            <!-- üß† Brain Pane -->
            <section id="brain" class="tab-pane">
              <h4>Brain Assistant</h4>
              <p>
                Use the Brain Assistant to generate outlines, chapters, and
                improve synopsis.
              </p>
              <div class="brain-controls">
                <select id="brainMode">
                  <option value="outline" selected>Suggest Outline</option>
                  <option value="chapter-titles">Suggest Chapter Titles</option>
                  <option value="improve-synopsis">Improve Synopsis</option>
                </select>
                <button id="brainRun" class="primary">Run</button>
              </div>
              <pre id="brainOut" class="brain-out">
Click ‚ÄúRun‚Äù to think with your current inputs‚Ä¶</pre>
              <button id="brainCopy" class="secondary">Copy to clipboard</button>
            </section>
          </app-tabs>
        </div>
      </div>
    </div>

    <!-- Off-canvas Brain panel -->
    <div
      id="brainPanel"
      class="brain-panel d-none"
      role="dialog"
      aria-modal="true"
      aria-labelledby="brainTitle"
    >
      <div class="brain-header">
        <h3 id="brainTitle" style="margin: 0">Brain Assistant</h3>
        <button id="brainClose" class="icon-btn" title="Close">‚úï</button>
      </div>
      <div class="brain-body">
        <div class="brain-controls">
          <select id="brainModePanel">
            <option value="outline" selected>Suggest Outline</option>
            <option value="chapter-titles">Suggest Chapter Titles</option>
            <option value="improve-synopsis">Improve Synopsis</option>
          </select>
          <button id="brainRunPanel" class="primary">Run</button>
        </div>
        <pre id="brainOutPanel" class="brain-out">
Click ‚ÄúRun‚Äù to think with your current inputs‚Ä¶</pre>
        <button id="brainCopyPanel" class="secondary">Copy to clipboard</button>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
      window.FIREBASE_API_KEY = "{{FIREBASE_API_KEY}}";
      window.FIREBASE_AUTH_DOMAIN = "{{FIREBASE_AUTH_DOMAIN}}";
      window.FIREBASE_PROJECT_ID = "{{FIREBASE_PROJECT_ID}}";
      window.FIREBASE_STORAGE_BUCKET = "{{FIREBASE_STORAGE_BUCKET}}";
      window.FIREBASE_MESSAGING_SENDER_ID = "{{FIREBASE_MESSAGING_SENDER_ID}}";
      window.FIREBASE_APP_ID = "{{FIREBASE_APP_ID}}";
      window.FIREBASE_MEASUREMENT_ID = "{{FIREBASE_MEASUREMENT_ID}}";
    </script>

    <!-- Modules -->
    <script type="module" src="./js/firebase.js"></script>
    <script type="module" src="./js/config.js"></script>
    <script type="module" src="./js/api.js"></script>
    <script type="module" src="./js/ui.js"></script>
    <script type="module" src="./js/storage.js"></script>
    <script type="module" src="./js/export.js"></script>
    <script type="module" src="./js/uploads.js"></script>
    <script type="module" src="./js/tabs.js"></script>
    <script type="module" src="js/app.js"></script>
  </body>
</html>
